CREATE TABLE EMP(EMPNO NUMBER(4,0),ENAME VARCHAR2(10),JOB VARCHAR2(9),MGR NUMBER(4,0),HIREDATE DATE,SAL NUMBER(7,2),COMM NUMBER(7,2),DEPTNO NUMBER(2,0));
INSERT INTO EMP VALUES(7839,'KING','PRESIDENT',NULL,'17-NOV-1981',5000,NULL,10);
INSERT INTO EMP VALUES(7782,'BLAKE','MANAGER',7839,'1-MAY-1981',2850,NULL,30);
INSERT INTO EMP VALUES(7782,'CLARK','MANAGER',7839,'9-JUN-1981',2450,NULL,10);
INSERT INTO EMP VALUES(7839,'JONES','MANAGER',7839,'2-apr-1981',2975,NULL,20);
INSERT INTO EMP VALUES(7839,'SCOTT','ANALYST',7566,'13-JUL-1981',3000,NULL,20);
INSERT INTO EMP VALUES(7839,'FORD','ANALYST',7566,'3-DEC-1981',3000,NULL,20);
INSERT INTO EMP VALUES(7839,'SMITH','CLERK',7902,'17-DEC-1980',800,NULL,20);
INSERT INTO EMP VALUES(7839,'ALLEN','SALESMAN',7698,'20-FEB-1981',1600,300,30);
INSERT INTO EMP VALUES(7839,'WARD','SALESMAN',7698,'22-FEB-1981',1250,500,30);
INSERT INTO EMP VALUES(7839,'MARTIN','SALESMAN',7698,'28-SEP-1981',1250,1400,30);
INSERT INTO EMP VALUES(7839,'TURNER','SALESMAN',7698,'8-SEP-1981',1500,0,30);
INSERT INTO EMP VALUES(7839,'ADAMS','CLERK',7788,'13-JUL-1981',1100,NULL,20);
INSERT INTO EMP VALUES(7839,'JAMES','CLERK',7698,'3-DEC-1981',950,NULL,30);
INSERT INTO EMP VALUES(7839,'MILLER','CLERK',7782,'23-JAN-1982',1350,NULL,10);
SELECT * FROM EMP;

SELECT * FROM DEPT;
INSERT INTO DEPT VALUES(10,'CSE','CHANDIGARH');
INSERT INTO DEPT VALUES(20,'ECE','PUNE');
INSERT INTO DEPT VALUES(30,'ME','BHOPAL');
INSERT INTO DEPT VALUES(40,'IT','RAJPURA');

CREATE TABLE DEPT2(DEPTNO NUMBER(4,0),DNAME VARCHAR2(10),LOC VARCHAR2(20),POS VARCHAR2(20),SAL1 NUMBER(7,2),SAL2 NUMBER(7,2));
INSERT INTO DEPT2 VALUES(10,'CSE','CHANDIGARH','ANALYST',1250,2000);
INSERT INTO DEPT2 VALUES(10,'ECE','PUNE','CLERK',1500,1600);
INSERT INTO DEPT2 VALUES(10,'ME','BHOPAL','CLERK',1250,2000);
INSERT INTO DEPT2 VALUES(40,'IT','RAJPURA','ANALYST',1500,1600);

--SELECT ENAME,DNAME,SAL,DEPTNO FROM DEPT,EMP;   --generate ambiguity
SELECT ENAME,DNAME,SAL,EMP.DEPTNO,DEPT.DEPTNO FROM DEPT,EMP; 
SELECT ENAME,DNAME,SAL,EMP.DEPTNO,DEPT.DEPTNO FROM EMP,DEPT WHERE EMP.DEPTNO=DEPT.DEPTNO;    --EQUIJOIN
SELECT ENAME,SAL,DNAME FROM EMP,DEPT WHERE EMP.DEPTNO=DEPT.DEPTNO;
SELECT ENAME,SAL,DNAME,E.DEPTNO FROM EMP E,DEPT D WHERE E.DEPTNO=D.DEPTNO;  --ALIASING
SELECT E.ENAME,E.SAL,D.DNAME,E.DEPTNO FROM EMP E,DEPT D WHERE E.DEPTNO=D.DEPTNO;
SELECT * FROM DEPT JOIN EMP ON(DEPT.DEPTNO=EMP.DEPTNO);  --ANSI SYNTAX
SELECT ENAME,SAL,DNAME,EMP.DEPTNO FROM EMP INNER JOIN DEPT ON EMP.DEPTNO=DEPT.DEPTNO; --ANSI SYNTAX

--NATURAL JOIN
SELECT ENAME,SAL,DNAME,EMP.DEPTNO,DEPT.DEPTNO FROM EMP,DEPT;
SELECT ENAME,SAL,DNAME FROM EMP NATURAL JOIN DEPT;  --IT WILL JOIN ON THE BASIS OF COMMON COLUMN
SELECT ENAME,SAL,DNAME,DEPTNO FROM EMP NATURAL JOIN DEPT; --COMBINE THE COMMON COLUMN
SELECT ENAME,SAL,DNAME,DEPTNO FROM EMP NATURAL JOIN DEPT ORDER BY DEPTNO DESC;
SELECT * FROM EMP NATURAL JOIN DEPT2;
--BECAUSE THERE IS NO COLUMN OR SAME COLUMN NAME AND DATA TYPE IN BOTH THE TABLES.NATURAL JOIN DOES NOT FIND ANY 
--COMMON THING SO IT PERFORMS JOIN CONDITION MEANS WITHOUT ANY CONDITION IE. CARTESIAN PRODUCT
SELECT DEPT.DEPTNO,DEPT.DNAME,DEPT.LOC,DEPT2.DEPTNO,DEPT2.DNAME,DEPT2.LOC FROM DEPT,DEPT2;

--OUTER JOIN
SELECT * FROM DEPT;
SELECT * FROM DEPT2;
SELECT * FROM DEPT,DEPT2;
SELECT * FROM DEPT,DEPT2 WHERE DEPT.DEPTNO=DEPT2.DEPTNO(+);  --LEFT OUTER JOIN ,THE TABLE WITH + SIGN IS DEFICIENT 
SELECT * FROM DEPT LEFT OUTER JOIN DEPT2 ON(DEPT.DEPTNO=DEPT2.DEPTNO);  --ANSI SYNTAX
SELECT * FROM DEPT,DEPT2 WHERE DEPT.DEPTNO(+)=DEPT2.DEPTNO;   --RIGHT OUTER JOIN
SELECT * FROM DEPT RIGHT OUTER JOIN DEPT2 ON(DEPT.DEPTNO=DEPT2.DEPTNO);  --ANSI SYNTAX
SELECT * FROM EMP FULL OUTER JOIN DEPT2 ON(EMP.DEPTNO=DEPT2.DEPTNO);  --FULL OUTER JOIN  


--SELF JOIN
SELECT * FROM EMP E,EMP M;
SELECT E.ENAME,M.ENAME FROM EMP E,EMP M WHERE E.MGR=M.EMPNO;
SELECT E.ENAME AS EMPLOYEE,M.ENAME AS MANAGER,E.DEPTNO,m.deptno FROM EMP E,EMP M WHERE E.MGR=M.EMPNO;
SELECT E.ENAME AS EMPLOYEE,M.ENAME AS MANAGER FROM EMP E,EMP M WHERE E.MGR=m.empno AND E.DEPTNO=M.DEPTNO;
SELECT E.ENAME AS EMPLOYEE,M.ENAME AS MANAGER,E.MGR,M.EMPNO,E.DEPTNO FROM EMP E,EMP M WHERE E.MGR=M.EMPNO AND E.DEPTNO=M.DEPTNO;
SELECT E.ENAME AS EMPLOYEE,M.ENAME AS MANAGER,E.HIREDATE,M.HIREDATE FROM EMP E,EMP M WHERE E.MGR=M.EMPNO AND E.DEPTNO=M.DEPTNO AND E.HIREDATE>M.HIREDATE;
SELECT E.ENAME AS EMPLOYEE,M.ENAME AS MANAGER FROM EMP E,EMP M WHERE E.MGR=M.EMPNO AND E.DEPTNO=M.DEPTNO AND E.ENAME!=M.ENAME;
SELECT E.ENAME AS EMPLOYEE,M.ENAME AS MANAGER FROM EMP E,EMP M WHERE E.MGR=M.EMPNO AND E.DEPTNO=M.DEPTNO AND E.ENAME='JONES';
SELECT E.ENAME AS EMPLOYEE,M.ENAME AS MANAGER FROM EMP E,EMP M WHERE E.MGR=M.EMPNO AND E.DEPTNO=M.DEPTNO AND E.ENAME='JONES' AND M.ENAME!='JONES';
SELECT E.ENAME ,M.ENAME FROM EMP E JOIN EMP M ON E.MGR=M.EMPNO;   --ANSI SYNTAX
SELECT E.ENAME ,M.ENAME FROM EMP E JOIN EMP M ON E.MGR=M.EMPNO WHERE E.HIREDATE>M.HIREDATE; 
